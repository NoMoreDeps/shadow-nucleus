!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EscOpeningChar="[",t.EscPositionClosingChar="H",t.EscColorClosingChar="m",t.endingForeColor=39,t.endingBackColor=49,t.Styles={bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},function(e){e.bold="bold",e.dim="dim",e.italic="italic",e.underline="underline",e.inverse="inverse",e.hidden="hidden",e.strikethrough="strikethrough"}(t.EStyle||(t.EStyle={})),t.ForeColor=[31,30,32,33,34,35,36,37,90,91,92,93,94,95,96,97],t.BackColor=[41,40,42,43,44,45,46,47,100,101,102,103,104,105,106,107],t.Color16={red:0,black:1,green:2,yellow:3,blue:4,magenta:5,cyan:6,lightGray:7,darkGray:8,lightRed:9,lightGreen:10,lightYellow:11,lightBlue:12,lightMagenta:13,lightCyan:14,white:15}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constantTree=function e(t,i=""){for(let n in t){const r=`${i}${""!==i?".":""}${n}`;"string"==typeof t[n]&&0===t[n].length?t[n]=r:"object"==typeof t[n]&&e(t[n],r)}return t}},function(e,t){e.exports=require("events")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=i(4),o=i(5),s=i(6),a=i(11),l=i(0),c=new a.Terminal;let u={};class d{entryPoint(e){return n(this,void 0,void 0,function*(){const t=yield e.Service.resolve(s.BaseComponent);t._Receive(r.Evts.CLI.PACKAGE.REGISTER,e=>{u[e.payload.doc.name||""]=e.payload,t._send(r.Evts.CLI.PACKAGE.REGISTERED,e)}),t._Receive(r.Evts.CLI.RUNNER.EXECUTE,e=>{!function(e){if(c.newLine().lightCyan("  _   _               _                    ").newLine().lightCyan(" | \\ | |             | |                   ").newLine().lightCyan(" |  \\| | _   _   ___ | |  ___  _   _  ___  ").newLine().lightCyan(" | . ' || | | | / __|| | / _ \\| | | |/ __| ").newLine().lightCyan(" | |\\  || |_| || (__ | ||  __/| |_| |\\__ \\ ").newLine().lightCyan(" \\_| \\_/ \\__,_| \\___||_| \\___| \\__,_||___/ ").newLine().lightMagenta(` Version ${o.AppDoc.version}`).newLine().newLine().green(" "+o.AppDoc.shortDescription).newLine().drawLine("-").newLine().write(),"help"===e.package)h();else if(e.package,e.package in u){const t=u[e.package].doc;if("help"===e.command)!function(e){c.lightCyan(" Package : ").lightGreen(e.name).newLine().text(" ").darkGray(e.description).newLine().drawLine("-").newLine().write();let t=0;for(let i in e.commands)t<i.length&&(t=i.length);t>0&&c.newLine().text(" ").drawColoredText("List of commands :",l.ForeColor[l.Color16.lightGray],void 0,l.EStyle.underline).newLine().newLine().write();for(let i in e.commands)c.text(" ").yellow(i).rightBy(t-i.length+1).text(" - ").darkGray(e.commands[i].shortDescription).newLine().write();if(c.newLine().write(),c.text(" ").drawColoredText("Usages :",l.ForeColor[l.Color16.lightGray],void 0,l.EStyle.underline).newLine().newLine().text(` ${o.AppDoc.appName} `).lightBlue(`${e.name}`).lightGray(" <").lightBlue("command").lightGray("> [<").lightBlue("parameter").lightGray("> [...<").lightBlue("parameter").lightGray(">]]").newLine().text(` ${o.AppDoc.appName} `).lightBlue(`${e.name}`).lightGray(" <").lightBlue("command").lightGray("> ").lightBlue("help").lightGray(" to get more help").newLine().write(),e.exemples){c.drawLine("-").newLine().text(" Examples :").drawLine("-").newLine().write();for(let t of e.exemples)c.yellow(t).newLine().write()}}(t);else{const i=e.command;e.parameters&&"help"in e.parameters?t.commands&&t.commands[i]?function(e,t){c.lightCyan(" Command : ").lightGreen(t.name).newLine().text(" ").darkGray(t.description).newLine().drawLine("-").newLine().write(),c.newLine().text(" ").drawColoredText("Usage :",l.ForeColor[l.Color16.lightGray],void 0,l.EStyle.underline).newLine().newLine().text(" ").text(o.AppDoc.appName).text(" ").lightBlue(e.name).text(" ").lightBlue(t.name).write(),t.parameters&&c.lightGray(" [<").lightBlue("parameter").lightGray("> [...<").lightBlue("parameter").lightGray(">]]").newLine().write();t.parameters&&c.newLine().drawLine("-").newLine().lightCyan(" Parameters").newLine().write();let i=0;for(let e in t.parameters)i<e.length&&(i=e.length);for(let n in t.parameters)if(c.drawLine("-").newLine().newLine().text(" ").yellow(n).rightBy(i-n.length+1).text(" - ").darkGray(t.parameters[n].description).newLine().write(),t.parameters[n].exemples){c.newLine().text(" ").drawColoredText("Examples :",void 0,void 0,l.EStyle.underline).newLine().newLine().write();for(let i of t.parameters[n].exemples)c.lightGray(` ${o.AppDoc.appName} `).lightBlue(`${e.name}`).lightGray(" ").lightBlue(`${t.name}`).lightGray(" ").yellow(`${t.parameters[n].name}`).lightGray("=").drawColoredText(i,l.ForeColor[l.Color16.lightCyan],void 0,l.EStyle.bold).newLine().write()}}(t,t.commands[i]):c.red(`Command <${i}> not found in package <${t.name}>`).newLine().write():t.commands&&t.commands[i]?u[e.package].runner&&"function"==typeof u[e.package].runner?u[e.package].runner(e):c.red(`No runner found to execute the following configuration ${JSON.stringify(e,null,2)}`).newLine().write():(c.red(`Command <${i}> not found in package <${t.name}>`).newLine().newLine().write(),h())}}else c.red(`Package named <${e.package}> was not found.`).newLine().newLine().write(),h()}(e.payload)}),t._sendSync(r.Evts.CLI.PACKAGE.REGISTER,{sender:t.identity,payload:{doc:o.module,runner:void 0}}),t._sendSync(r.Evts.CLI.PACKAGE.REGISTER,{sender:t.identity,payload:{doc:o._package,runner:e=>{"list"===e.command&&function(){c.write(),c.darkGray(" List of all packages currently installed").newLine().drawLine("-").newLine().write();let e=0;for(let t in u)e<t.length&&(e=t.length);for(let t in u)c.text(" ").yellow(t).rightBy(e-t.length+1).text(" - ").darkGray(u[t].doc.shortDescription).newLine().write()}()}}})})}}function h(){c.darkGray(" Global usage : ").lightGray(` ${o.AppDoc.appName} <`).lightBlue("package").lightGray("> <").lightBlue("command").lightGray("> [<").lightBlue("argument").lightGray("> | <").lightBlue("argument").lightGray("=").lightBlue("value").lightGray("> [...]]").newLine().newLine().darkGray(" For more information you can type :").newLine().newLine().lightGray(` ${o.AppDoc.appName} <`).lightBlue("package").lightGray("> ").lightBlue("help").lightGray(" to get package help").newLine().lightGray(` ${o.AppDoc.appName} <`).lightBlue("package").lightGray("> <").lightBlue("command").lightGray("> ").lightBlue("help").lightGray(" to get command help").newLine().lightGray(` ${o.AppDoc.appName} `).lightBlue("package").lightGray(" ").lightBlue("list").lightGray(" to get all package names").newLine().write()}t.default=d,s.connect(d)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(1).constantTree({CLI:{PACKAGE:{REGISTER:"",REGISTERED:""},RUNNER:{EXECUTE:"",EXECUTED:""}}});t.Evts=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.module={name:"module",shortDescription:"All modules related actions",description:"Create / Install / Remove and manage modules.",commands:{build:{name:"build",shortDescription:"Build a module",description:"Build a module and all the services",parameters:{mod:{name:"mod",type:"string",required:!0,description:"The module's name",exemples:["myTargetModule"]},target:{name:"target",type:"string",required:!0,description:"the target, should be <back> or <front>",exemples:["back","front"]},tsc:{name:"tsc",type:"string",required:!0,description:"The path to the tsconfig file to use instead of default parameters",exemples:["../"]},wp:{name:"wp",type:"string",required:!0,description:"The path to the webpack config file to use instead of default parameters",exemples:["../"]}}},add:{name:"add",shortDescription:"Create a new module",description:"Create a new module with all necessary code templates",parameters:{dest:{name:"dest",description:"Destination folder to create files in. By default, '.' is the target folder",required:!1,type:"string",exemples:[".","./destinationFolder"]}}},get:{name:"get",shortDescription:"retreive one or more module from a repository or cache",description:"Retreive one or more modules from a repository.",usages:["nc module get list=com.nucleus-websocket,com.nucleus-upload","nc module get catalog=react"],parameters:{list:{name:"list",description:"List of all module to retreive, coma separated, without any space",type:"String",required:!1,exemples:["com.nucleus-websocket,com.nucleus-upload","com.nucleus-websocket"]},catalog:{name:"catalog",description:"Get all packages previously saved in a local catalog list",type:"String",required:!1,exemples:["create-react-app"]}}}}},t._package={name:"package",shortDescription:"All package actions available",description:"The package <package> handle all installed packages, new installation, update and delete",commands:{list:{name:"list",description:"List all packages installed / and locally available",shortDescription:"List all packages available",usages:["nc package list"],exemples:["nc package list"]}}},t.AppDoc={name:"Nucleus",appName:"nc",version:"1.0.0",shortDescription:"Plugin based architecture for frontend and backend"}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(7);t.BaseComponent=o.BaseComponent;const s=r(i(9));t.UtilEnv=s;const a=r(i(1));t.UtilConstant=a;const l=i(10);t.Ioc=l.Ioc,t.connect=function(e){return n(this,void 0,void 0,function*(){yield _nucleus(e)})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(8);t.BaseComponent=class{constructor(){this._NC_TYPE_="BaseComponent",this.cmpId="",this.cmpName="",this.getService=void 0}_send(e,t){this._evtBus&&this._evtBus.emitAsync(e,t)}_sendSync(e,t){this._evtBus&&this._evtBus.emit(e,t)}_sendWithReturn(e,t,i){return new Promise((r,o)=>{this._evtBus?(this._evtBus.once(t,e=>{r(e)}),this._evtBus.emitAsync(e,i)):o(Error(n.Errors.TECHNICAL.EVENTBUS_IS_NOT_DEFINED))})}_Receive(e,t){return this._evtBus?this._evtBus.on(e,t):{off:()=>void 0}}_ReceiveOnce(e,t){return this._evtBus?this._evtBus.once(e,t):{off:()=>void 0}}get identity(){return{cmpId:this.cmpId,cmpName:this.cmpName}}initialize(){}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(1).constantTree({TYPE:{TECHNICAL:"",BUSINESS:""},TECHNICAL:{EVENTBUS_IS_NOT_DEFINED:""}});t.Errors=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNode=function(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ioc=function(e){return function(t){t.prototype.__nc__Services=e}},t.DI=function(e,t){console.log(e,t)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(12),r=i(0),o=i(0);t.Terminal=class extends n.BaseTerminal{constructor(){super(),this.red=void 0,this.black=void 0,this.green=void 0,this.yellow=void 0,this.blue=void 0,this.magenta=void 0,this.cyan=void 0,this.lightGray=void 0,this.darkGray=void 0,this.lightRed=void 0,this.lightGreen=void 0,this.lightYellow=void 0,this.lightBlue=void 0,this.lightMagenta=void 0,this.lightCyan=void 0,this.white=void 0,this.bgRed=void 0,this.bgBlack=void 0,this.bgGreen=void 0,this.bgYellow=void 0,this.bgBlue=void 0,this.bgMagenta=void 0,this.bgCyan=void 0,this.bgLightGray=void 0,this.bgDarkGray=void 0,this.bgLightRed=void 0,this.bgLightGreen=void 0,this.bgLightYellow=void 0,this.bgLightBlue=void 0,this.bgLightMagenta=void 0,this.bgLightCyan=void 0,this.bgWhite=void 0;for(let e in o.Color16)this[e]=function(t=""){return""===t?this:this._color(o.ForeColor[o.Color16[e]]).text(t)._color(o.endingForeColor)},this[`bg${e[0].toUpperCase()+e.substr(1)}`]=function(t=""){return""===t?this:this._color(o.BackColor[o.Color16[e]]).text(t)._color(o.endingBackColor)};for(let e in r.Styles)this[e]=function(t=""){return""===t?this:this._color(r.Styles[e][0]).text(t)._color(r.Styles[e][1])}}drawColoredText(e,t,i,n){return t&&this._color(t),i&&this._color(i),n&&this._color(r.Styles[n][0]),this.text(e),n&&this._color(r.Styles[n][1]),i&&this._color(o.endingBackColor),t&&this._color(o.endingForeColor),this}getAndClearBuffer(){const e=this._buffer;return this.clearBuffer(),e}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(13),o=i(2);t.BaseTerminal=class extends o.EventEmitter{constructor(){super(),this._x=0,this._y=0,this._buffer="",process.stdin.setEncoding("utf8"),this._streamWriterDataEventHandler=void 0,this.on("write",e=>{this._streamWriterDataEventHandler&&this._streamWriterDataEventHandler(e)})}_color(e){return this._buffer+=`${n.EscOpeningChar}${e}${n.EscColorClosingChar}`,this}_colorExt(e){return this._buffer+=`${n.EscOpeningChar}38;5;${e}${n.EscColorClosingChar}`,this}_bgColorExt(e){return this._buffer+=`${n.EscOpeningChar}48;5;${e}${n.EscColorClosingChar}`,this}set onWrite(e){this._streamWriterDataEventHandler=e}get onWrite(){return this._streamWriterDataEventHandler}reset(){return this._color(0)._color(0)}clearTerminal(){return process.stdout.write(`${n.EscOpeningChar}2J`),this}drawLine(e=""){""===e&&(e=" "),"string"==typeof e&&e.length>1&&(e=e.charAt(0));let t="";for(let i=0;i<this.cols-1;i++)t+=e;return this.text(t),this}to(e,t){return this._buffer+=`${n.EscOpeningChar}${e};${t}${n.EscPositionClosingChar}`,this}toptBy(e){return this._buffer+=`[${e}A`,this}bottomBy(e){return this._buffer+=`[${e}B`,this}rightBy(e){return this._buffer+=`[${e}C`,this}leftBy(e){return this._buffer+=`[${e}D`,this}saveCursorPosition(){return this._buffer+="[s",this}restoreCursorPosition(){return this._buffer+="[u",this}clearLine(){return this._buffer+="[k",this}row(e){return this._buffer+=`${n.EscOpeningChar}${e}${n.EscPositionClosingChar}`,this}col(e){return this._buffer+=`${n.EscOpeningChar};${e}${n.EscPositionClosingChar}`,this}ext(e){return this._colorExt(e)}bgExt(e){return this._bgColorExt(e)}text(e){return e?(this._buffer+=e.toString(),this):this}newLine(){return this._buffer+="\n",this}stringify(e){return this._buffer+=JSON.stringify(e,null,2),this}clear(){console.clear()}clearBuffer(){this._buffer=""}write(e){return void 0!==e&&this.text(e),process.stdout.write(this._buffer),this._buffer="",this}get rows(){return process.stdout.rows||0}get cols(){return process.stdout.columns||0}stopListen(){void 0!==process.stdin.setRawMode&&process.stdin.setRawMode(!1),process.stdin.removeAllListeners(),process.stdin.unpipe()}listenInputs(e=!1,t){let i=t||new r.TerminalStreamWriter(this);i.on("write",e=>{this.emit("write",e)}),i.on("pipe",t=>{i.src=t,t.setRawMode(e)}),process.stdin.pipe(i)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(2);t.TerminalStreamWriter=class extends n.EventEmitter{constructor(e){super(),this.term=e,this.writable=!0}write(...e){return this.emit("write",e),""===e[0]&&(this.src.setRawMode(!1),console.log("End (press enter to exit)"),process.stdin.removeAllListeners(),process.stdin.unpipe(this)),!0}end(...e){console.log("end",e)}}}]);