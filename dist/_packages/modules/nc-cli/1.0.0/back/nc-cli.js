!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=6)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constantTree=function e(t,i=""){for(let n in t){const r=`${i}${""!==i?".":""}${n}`;"string"==typeof t[n]&&0===t[n].length?t[n]=r:"object"==typeof t[n]&&e(t[n],r)}return t}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EscOpeningChar="[",t.EscPositionClosingChar="H",t.EscColorClosingChar="m",t.endingForeColor=39,t.endingBackColor=49,t.Styles={bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},function(e){e.bold="bold",e.dim="dim",e.italic="italic",e.underline="underline",e.inverse="inverse",e.hidden="hidden",e.strikethrough="strikethrough"}(t.EStyle||(t.EStyle={})),t.ForeColor=[31,30,32,33,34,35,36,37,90,91,92,93,94,95,96,97],t.BackColor=[41,40,42,43,44,45,46,47,100,101,102,103,104,105,106,107],t.Color16={red:0,black:1,green:2,yellow:3,blue:4,magenta:5,cyan:6,lightGray:7,darkGray:8,lightRed:9,lightGreen:10,lightYellow:11,lightBlue:12,lightMagenta:13,lightCyan:14,white:15}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static generate2bytesNumber(){const e=Math.round(65535*Math.random());return[e,n.pad(e.toString(16),4)]}static generate4bytesNumber(){const e=Math.round(4294967295*Math.random());return[e,n.pad(e.toString(16),8)]}static generate6bytesNumber(){const e=Math.round(0xffffffffffff*Math.random());return[e,n.pad(e.toString(16),12)]}static pad(e,t){var i="";for(let e=0;e<t;e++)i+="0";return(i+e).substr(-t)}constructor(){const[e,t]=n.generate4bytesNumber(),[i,r]=n.generate2bytesNumber(),[o,s]=n.generate2bytesNumber(),[a,l]=n.generate2bytesNumber(),[c,u]=n.generate6bytesNumber();this._Guid_={part1:e,part2:i,part3:o,part4:a,part5:c,toString:`${t}-${r}-${s}-${l}-${u}`}}get part1(){return this._Guid_.part1}get part2(){return this._Guid_.part2}get part3(){return this._Guid_.part3}get part4(){return this._Guid_.part4}get part5(){return this._Guid_.part5}toString(){return this._Guid_.toString}static getGuid(){return(new n).toString()}}t.Guid=n},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(7),s=i(8),a=i(9),l=i(14),c=i(1),u=i(17),d=i(19),h=i(20),p=i(2),g=r(i(21)),f=new l.Terminal;let m={};class y{entryPoint(e){return n(this,void 0,void 0,function*(){const t=yield e.Service.resolve(a.BaseComponent);t._Receive(o.Evts.CLI.PACKAGE.REGISTER,e=>{m[e.payload.doc.name||""]=e.payload,t._Send(o.Evts.CLI.PACKAGE.REGISTERED,e)}),t._Receive(o.Evts.CLI.RUNNER.EXECUTE,e=>n(this,void 0,void 0,function*(){yield function(e){return n(this,void 0,void 0,function*(){if(f.newLine().lightCyan("  _   _               _                    ").newLine().lightCyan(" | \\ | |             | |                   ").newLine().lightCyan(" |  \\| | _   _   ___ | |  ___  _   _  ___  ").newLine().lightCyan(" | . ' || | | | / __|| | / _ \\| | | |/ __| ").newLine().lightCyan(" | |\\  || |_| || (__ | ||  __/| |_| |\\__ \\ ").newLine().lightCyan(" \\_| \\_/ \\__,_| \\___||_| \\___| \\__,_||___/ ").newLine().lightMagenta(` Version ${s.AppDoc.version}`).newLine().newLine().green(" "+s.AppDoc.shortDescription).newLine().drawLine("-").newLine().write(),"help"===e.package)_();else if(e.package,e.package in m){const t=m[e.package].doc;if("help"===e.command)!function(e){f.lightCyan(" Package : ").lightGreen(e.name).newLine().text(" ").darkGray(e.description).newLine().drawLine("-").newLine().write();let t=0;for(let i in e.commands)t<i.length&&(t=i.length);t>0&&f.newLine().text(" ").drawColoredText("List of commands :",c.ForeColor[c.Color16.lightGray],void 0,c.EStyle.underline).newLine().newLine().write();for(let i in e.commands)f.text(" ").yellow(i).rightBy(t-i.length+1).text(" - ").darkGray(e.commands[i].shortDescription).newLine().write();if(f.newLine().write(),f.text(" ").drawColoredText("Usages :",c.ForeColor[c.Color16.lightGray],void 0,c.EStyle.underline).newLine().newLine().text(` ${s.AppDoc.appName} `).lightBlue(`${e.name}`).lightGray(" <").lightBlue("command").lightGray("> [<").lightBlue("parameter").lightGray("> [...<").lightBlue("parameter").lightGray(">]]").newLine().text(` ${s.AppDoc.appName} `).lightBlue(`${e.name}`).lightGray(" <").lightBlue("command").lightGray("> ").lightBlue("help").lightGray(" to get more help").newLine().write(),e.exemples){f.drawLine("-").newLine().text(" Examples :").drawLine("-").newLine().write();for(let t of e.exemples)f.yellow(t).newLine().write()}}(t);else{const i=e.command;e.parameters&&"help"in e.parameters?t.commands&&t.commands[i]?function(e,t){f.lightCyan(" Command : ").lightGreen(t.name).newLine().text(" ").darkGray(t.description).newLine().drawLine("-").newLine().write(),f.newLine().text(" ").drawColoredText("Usage :",c.ForeColor[c.Color16.lightGray],void 0,c.EStyle.underline).newLine().newLine().text(" ").text(s.AppDoc.appName).text(" ").lightBlue(e.name).text(" ").lightBlue(t.name).write(),t.parameters&&f.lightGray(" [<").lightBlue("parameter").lightGray("> [...<").lightBlue("parameter").lightGray(">]]").newLine().write();t.parameters&&f.newLine().drawLine("-").newLine().lightCyan(" Parameters").newLine().write();let i=0;for(let e in t.parameters)i<e.length&&(i=e.length);for(let n in t.parameters)if(f.drawLine("-").newLine().newLine().text(" ").yellow(n).rightBy(i-n.length+1).text(" - ").darkGray(t.parameters[n].description).newLine().write(),t.parameters[n].exemples){f.newLine().text(" ").drawColoredText("Examples :",void 0,void 0,c.EStyle.underline).newLine().newLine().write();for(let i of t.parameters[n].exemples)f.lightGray(` ${s.AppDoc.appName} `).lightBlue(`${e.name}`).lightGray(" ").lightBlue(`${t.name}`).lightGray(" ").yellow(`${t.parameters[n].name}`).lightGray("=").drawColoredText(i,c.ForeColor[c.Color16.lightCyan],void 0,c.EStyle.bold).newLine().write()}}(t,t.commands[i]):f.red(`Command <${i}> not found in package <${t.name}>`).newLine().write():t.commands&&t.commands[i]?m[e.package].runner&&"function"==typeof m[e.package].runner?m[e.package].runner(e):f.red(`No runner found to execute the following configuration ${JSON.stringify(e,null,2)}`).newLine().write():(f.red(`Command <${i}> not found in package <${t.name}>`).newLine().newLine().write(),_())}}else f.red(`Package named <${e.package}> was not found.`).newLine().newLine().write(),_()})}(e.payload)})),t._SendSync(o.Evts.CLI.PACKAGE.REGISTER,{sender:d.CLI_IDENTITY,payload:{doc:s.module,runner:function(e){return n(this,void 0,void 0,function*(){switch(e.command){case"init":console.log("Initialize a new project");const i=yield t._SendWithReturn("CLI.ENV.GET_INFO","CLI.ENV.INFO_GOTTEN",{sender:this.identity,payload:{guid:p.Guid.getGuid()}});g.mkDirSync(`${i.payload.callerPath}/nc-repo`),g.mkDirSync(`${i.payload.callerPath}/nc-bin`),g.mkDirSync(`${i.payload.callerPath}/nc-dist`),f.write();yield f.getNextinputChoice(["Choice 1","Choice 2","Choice 3"]);return void f.newLine().write("Done !");case"build":let{mod:n,target:r}=e.parameters;n=n||"",r="front"!==r&&"back"!==r?"front":r,u.Build.buildModule.call(this,n,r);break;case"new":let{name:o,path:s}=e.parameters;h.New.newModule.call(this,{moduleName:o,modulePath:s})}})}.bind(t)}}),t._SendSync(o.Evts.CLI.PACKAGE.REGISTER,{sender:d.CLI_IDENTITY,payload:{doc:s._package,runner:e=>n(this,void 0,void 0,function*(){"list"===e.command&&function(){f.write(),f.darkGray(" List of all packages currently installed").newLine().drawLine("-").newLine().write();let e=0;for(let t in m)e<t.length&&(e=t.length);for(let t in m)f.text(" ").yellow(t).rightBy(e-t.length+1).text(" - ").darkGray(m[t].doc.shortDescription).newLine().write()}()})}})})}}function _(){f.darkGray(" Global usage : ").lightGray(` ${s.AppDoc.appName} <`).lightBlue("package").lightGray("> <").lightBlue("command").lightGray("> [<").lightBlue("argument").lightGray("> | <").lightBlue("argument").lightGray("=").lightBlue("value").lightGray("> [...]]").newLine().newLine().darkGray(" For more information you can type :").newLine().newLine().lightGray(` ${s.AppDoc.appName} <`).lightBlue("package").lightGray("> ").lightBlue("help").lightGray(" to get package help").newLine().lightGray(` ${s.AppDoc.appName} <`).lightBlue("package").lightGray("> <").lightBlue("command").lightGray("> ").lightBlue("help").lightGray(" to get command help").newLine().lightGray(` ${s.AppDoc.appName} `).lightBlue("package").lightGray(" ").lightBlue("list").lightGray(" to get all package names").newLine().write()}t.default=y,a.connect(y)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0).constantTree({CLI:{PACKAGE:{REGISTER:"",REGISTERED:""},RUNNER:{EXECUTE:"",EXECUTED:""}}});t.Evts=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.module={name:"module",shortDescription:"All modules related actions",description:"Create / Install / Remove and manage modules.",commands:{build:{name:"build",shortDescription:"Build a module",description:"Build a module and all the services",parameters:{mod:{name:"mod",type:"string",required:!0,description:"The module's name",exemples:["myTargetModule"]},target:{name:"target",type:"string",required:!0,description:"the target, should be <back> or <front>",exemples:["back","front"]},tsc:{name:"tsc",type:"string",required:!1,description:"The path to the tsconfig file to use instead of default parameters",exemples:["../"]},wp:{name:"wp",type:"string",required:!1,description:"The path to the webpack config file to use instead of default parameters",exemples:["../"]}}},new:{name:"new",shortDescription:"Create a new module",description:"Create a new module with all necessary code templates",parameters:{name:{name:"name",type:"string",description:"Module name",exemples:["nc-package"]},dest:{name:"path",description:"  Destination folder to create files in. By default, '.' is the target folder\n  If running th ecommand from th eroot directory, it will creates packages in ./src/packages",required:!1,type:"string",exemples:[".","./destinationFolder"]}}},add:{name:"add",shortDescription:"Create a new module",description:"Create a new module with all necessary code templates",parameters:{dest:{name:"dest",description:"Destination folder to create files in. By default, '.' is the target folder",required:!1,type:"string",exemples:[".","./destinationFolder"]}}},get:{name:"get",shortDescription:"retreive one or more module from a repository or cache",description:"Retreive one or more modules from a repository.",usages:["nc module get list=com.nucleus-websocket,com.nucleus-upload","nc module get catalog=react"],parameters:{list:{name:"list",description:"List of all module to retreive, coma separated, without any space",type:"String",required:!1,exemples:["com.nucleus-websocket,com.nucleus-upload","com.nucleus-websocket"]},catalog:{name:"catalog",description:"Get all packages previously saved in a local catalog list",type:"String",required:!1,exemples:["create-react-app"]}}},init:{description:"init a new project",name:"init"}}},t._package={name:"package",shortDescription:"All package actions available",description:"The package <package> handle all installed packages, new installation, update and delete",commands:{list:{name:"list",description:"List all packages installed / and locally available",shortDescription:"List all packages available",usages:["nc package list"],exemples:["nc package list"]}}},t.AppDoc={name:"Nucleus",appName:"nc",version:"1.0.0",shortDescription:"Plugin based architecture for frontend and backend"}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(10);t.BaseComponent=o.BaseComponent;const s=r(i(12));t.UtilEnv=s;const a=r(i(0));t.UtilConstant=a;const l=i(13);t.IocInject=l.IocInject,t.IocResolve=l.IocResolve,t.connect=function(e){return n(this,void 0,void 0,function*(){yield _nucleus(e)})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(11);t.BaseComponent=class{constructor(){this._NC_TYPE_="BaseComponent",this.serviceId="",this.serviceName="",this.getService=void 0}_Send(e,t){this._EvtBus&&this._EvtBus.emitAsync(e,t)}_SendSync(e,t){this._EvtBus&&this._EvtBus.emit(e,t)}_SendWithReturn(e,t,i){return new Promise((r,o)=>{if(null!==i.payload.guid&&void 0!==i.payload.guid||o(Error(n.Errors.TECHNICAL.GUID_IS_MISSING)),this._EvtBus){const n=this._EvtBus.on(t,e=>{e.payload.guid===i.payload.guid&&(n.off(),r(e))});this._EvtBus.emitAsync(e,i)}else o(Error(n.Errors.TECHNICAL.EVENTBUS_IS_NOT_DEFINED))})}_Receive(e,t){return this._EvtBus?this._EvtBus.on(e,t):{off:()=>void 0}}_ReceiveOnce(e,t){return this._EvtBus?this._EvtBus.once(e,t):{off:()=>void 0}}get identity(){return{serviceId:this.serviceId,serviceName:this.serviceName}}initialize(){}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=i(0).constantTree({TYPE:{TECHNICAL:"",BUSINESS:""},TECHNICAL:{EVENTBUS_IS_NOT_DEFINED:"",GUID_IS_MISSING:""}});t.Errors=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNode=function(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IocInject=function(e){return()=>void 0},t.IocResolve=function(e){return()=>void 0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(15),r=i(1),o=i(1);t.Terminal=class extends n.BaseTerminal{constructor(){super(),this.red=void 0,this.black=void 0,this.green=void 0,this.yellow=void 0,this.blue=void 0,this.magenta=void 0,this.cyan=void 0,this.lightGray=void 0,this.darkGray=void 0,this.lightRed=void 0,this.lightGreen=void 0,this.lightYellow=void 0,this.lightBlue=void 0,this.lightMagenta=void 0,this.lightCyan=void 0,this.white=void 0,this.bgRed=void 0,this.bgBlack=void 0,this.bgGreen=void 0,this.bgYellow=void 0,this.bgBlue=void 0,this.bgMagenta=void 0,this.bgCyan=void 0,this.bgLightGray=void 0,this.bgDarkGray=void 0,this.bgLightRed=void 0,this.bgLightGreen=void 0,this.bgLightYellow=void 0,this.bgLightBlue=void 0,this.bgLightMagenta=void 0,this.bgLightCyan=void 0,this.bgWhite=void 0;for(let e in o.Color16)this[e]=function(t=""){return""===t?this:this._color(o.ForeColor[o.Color16[e]]).text(t)._color(o.endingForeColor)},this[`bg${e[0].toUpperCase()+e.substr(1)}`]=function(t=""){return""===t?this:this._color(o.BackColor[o.Color16[e]]).text(t)._color(o.endingBackColor)};for(let e in r.Styles)this[e]=function(t=""){return""===t?this:this._color(r.Styles[e][0]).text(t)._color(r.Styles[e][1])}}drawColoredText(e,t,i,n){return t&&this._color(t),i&&this._color(i),n&&this._color(r.Styles[n][0]),this.text(e),n&&this._color(r.Styles[n][1]),i&&this._color(o.endingBackColor),t&&this._color(o.endingForeColor),this}getAndClearBuffer(){const e=this._buffer;return this.clearBuffer(),e}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=i(1),o=i(16),s=i(3);t.BaseTerminal=class extends s.EventEmitter{constructor(){super(),this._x=0,this._y=0,this._buffer="",process.stdin.setEncoding("utf8"),this._streamWriterDataEventHandler=void 0,this.on("write",e=>{this._streamWriterDataEventHandler&&this._streamWriterDataEventHandler(e)})}_color(e){return this._buffer+=`${r.EscOpeningChar}${e}${r.EscColorClosingChar}`,this}_colorExt(e){return this._buffer+=`${r.EscOpeningChar}38;5;${e}${r.EscColorClosingChar}`,this}_bgColorExt(e){return this._buffer+=`${r.EscOpeningChar}48;5;${e}${r.EscColorClosingChar}`,this}set onWrite(e){this._streamWriterDataEventHandler=e}get onWrite(){return this._streamWriterDataEventHandler}reset(){return this._color(0)._color(0)}clearTerminal(){return process.stdout.write(`${r.EscOpeningChar}2J`),this}getNextinputChoice(e){return n(this,void 0,void 0,function*(){return this.listenInputs(!0),new Promise((e,t)=>{process.stdin.on("keypress",(e,t)=>{console.log(e,t)}),this.onWrite=(t=>{console.log(t,t.length,t[0].length),t.forEach(t=>{switch(t.charCodeAt(0)){case 13:this.stopListen(),this.newLine().write(),e(0);break;default:this.write(t.charCodeAt(0)).write(" ")}})})})})}getNextInput(e,t=!1){return n(this,void 0,void 0,function*(){return e&&this.write(e),new Promise((e,i)=>{try{let n="";this.onWrite=(i=>{const r=i.join();n+=r,this.write(t?"*":r),13===r.charCodeAt(0)&&(this.stopListen(),this.newLine().write(),e(n))}),this.listenInputs(!0)}catch(e){i(e)}})})}drawLine(e=""){""===e&&(e=" "),"string"==typeof e&&e.length>1&&(e=e.charAt(0));let t="";for(let i=0;i<this.cols-1;i++)t+=e;return this.text(t),this}to(e,t){return this._buffer+=`${r.EscOpeningChar}${e};${t}${r.EscPositionClosingChar}`,this}toptBy(e){return this._buffer+=`[${e}A`,this}bottomBy(e){return this._buffer+=`[${e}B`,this}rightBy(e){return this._buffer+=`[${e}C`,this}leftBy(e){return this._buffer+=`[${e}D`,this}saveCursorPosition(){return this._buffer+="[s",this}restoreCursorPosition(){return this._buffer+="[u",this}clearLine(){return this._buffer+="[k",this}row(e){return this._buffer+=`${r.EscOpeningChar}${e}${r.EscPositionClosingChar}`,this}col(e){return this._buffer+=`${r.EscOpeningChar};${e}${r.EscPositionClosingChar}`,this}ext(e){return this._colorExt(e)}bgExt(e){return this._bgColorExt(e)}text(e){return e?(this._buffer+=e.toString(),this):this}newLine(){return this._buffer+="\n",this}stringify(e){return this._buffer+=JSON.stringify(e,null,2),this}clear(){console.clear()}clearBuffer(){this._buffer=""}write(e){return void 0!==e&&this.text(e),process.stdout.write(this._buffer),this._buffer="",this}get rows(){return process.stdout.rows||0}get cols(){return process.stdout.columns||0}stopListen(){void 0!==process.stdin.setRawMode&&process.stdin.setRawMode(!1),process.stdin.removeAllListeners(),process.stdin.unpipe(this._WritableStream)}listenInputs(e=!1,t){this._WritableStream=t||new o.TerminalStreamWriter(this),this._WritableStream.on("write",e=>{this.emit("write",e)}),this._WritableStream.on("pipe",t=>{this._WritableStream.src=t,t.setRawMode(e)}),process.stdin.pipe(this._WritableStream),process.stdin.setRawMode&&process.stdin.setRawMode(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(3);t.TerminalStreamWriter=class extends n.EventEmitter{constructor(e){super(),this.term=e,this.writable=!0}write(...e){return this.emit("write",e),""===e[0]&&(this.src.setRawMode(!1),console.log("End (press enter to exit)"),process.stdin.removeAllListeners(),process.stdin.unpipe(this)),!0}end(...e){console.log("end",e)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=i(2),s=i(18),a=r(i(4)),l=i(5);t.Build=class{static buildModule(e,t){return n(this,void 0,void 0,function*(){const t=o.Guid.getGuid();let i={},n={};this._Receive(s.Evts.TSC.COMPILER.WRITE_FILE,e=>{i._filled="true",i[e.payload.path]=e.payload.content}),this._Receive(s.Evts.TSC.DIAGNOSTIC.ERROR,e=>{n._filled=!0,n[e.payload.fileName]=e.payload});try{yield this._SendWithReturn(s.Evts.TSC.COMPILER.COMPILE,s.Evts.TSC.COMPILER.COMPILED,{sender:this.identity,payload:{guid:t,sources:[e],options:{target:2,module:1,jsx:2,strict:!1,esModuleInterop:!0,experimentalDecorators:!0,outDir:"./out2"}}})}catch(e){console.log("Error",e)}if(n._filled,i._filled){var r=new RegExp('__decorate\\(\\[.*?IocResolve\\((.*?)\\).*?\\],\\s*(.*?),\\s*"(.*?)"',"is"),c=new RegExp("(\\w*?) = __decorate\\(\\[.*?IocInject\\((.*?)\\).*?\\],\\s*(.*?)\\);","is");function u(e){var t=a.dirname(e);if(l.existsSync(t))return!0;u(t),l.mkdirSync(t)}for(let e in i){var d;if("_filled"!==e&&((d=r.exec(i[e]))&&console.log(`Resolve request detected in file ${e}, Property ${d[3]} in class ${d[2].split(".")[0]} is of type ${d[1]}`),d=c.exec(i[e]))){var h=new RegExp(d[1]+" = class "+d[3]+' extends .*?this\\.serviceName = "(.*?)"',"is").exec(i[e]),p=new RegExp(d[1]+" = class "+d[3]+' extends .*?this\\.serviceId = "(.*?)"',"is").exec(i[e]);console.log(`Inject request detected in file ${e}, Class ${d[3]} whose generated name is ${d[1]} is registered in module { name : ${h&&h[1]}, id: ${p&&p[1]} as type ${d[2]}}`)}u(e),l.writeFileSync(e,i[e],{encoding:"utf8",flag:"w"})}}})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0).constantTree({TSC:{COMPILER:{COMPILE:"",COMPILED:"",WRITE_FILE:""},DIAGNOSTIC:{ERROR:""}}});t.Evts=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLI_ALL_EVENTS="allEvents",t.CLI_IDENTITY={serviceName:"CLI",serviceId:"com.nucleus"}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=i(2);t.New=class{static newModule(e){return n(this,void 0,void 0,function*(){e.modulePath=e.modulePath||".";const t=(yield this._SendWithReturn("CLI.ENV.GET_INFO","CLI.ENV.INFO_GOTTEN",{sender:this.identity,payload:{guid:r.Guid.getGuid()}})).payload;console.log(JSON.stringify(t,null,2))})}}},function(e,t,i){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=n(i(5)),o=n(i(4));function s(e){var t=e.replace(/\\\\/g,"/").split("/");t.reduce((e,t)=>{let i=`${e}`;return e&&(t=`${e}/${t}`),!r.existsSync(i)&&r.mkdirSync(i),i=`${t}`,!r.existsSync(i)&&r.mkdirSync(i),t}),1===t.length&&!r.existsSync(e)&&r.mkdirSync(e)}t.execSync=function(e){return i(22).execSync(e)},t.existsSync=function(e){return r.existsSync(e)},t.mkDirSync=s,t.renameSync=function(e,t){r.renameSync(e,t)},t.copySync=function e(t,i){let n=`${t}`,a=[],l=[];r.lstatSync(n).isDirectory()?r.existsSync(`${n}`)&&r.readdirSync(n).forEach(e=>{r.lstatSync(`${t}/${e}`).isFile()?a.push(e):r.lstatSync(`${t}/${e}`).isDirectory()&&l.push(e)}):a.push(n),a.forEach(e=>{s(i),r.lstatSync(n).isDirectory()?r.copyFileSync(`${t}/${e}`,`${i}/${e}`):r.copyFileSync(`${e}`,`${i}/${o.basename(e)}`)}),l.forEach(n=>{s(`${i}/${n}`),e(`${t}/${n}`,`${i}/${n}`)})},t.rmDirSync=function e(t){let i=`${t}`,n=[],o=[];r.existsSync(`${t}`)&&r.readdirSync(i).forEach(e=>{r.lstatSync(`${t}/${e}`).isFile()?n.push(e):r.lstatSync(`${t}/${e}`).isDirectory()&&o.push(e)}),n.forEach(e=>{r.unlinkSync(`${t}/${e}`)}),o.forEach(i=>{e(`${t}/${i}`)}),r.existsSync(`${t}`)&&r.rmdirSync(`${t}`)}},function(e,t){e.exports=require("child_process")}]);